<source>
  @type forward
  port 24224
  bind 0.0.0.0
</source>

# Save error logs to a separate file
<match express.error_**>
  @type file
  path /fluentd/log/errors
  append true
  <buffer time>
    timekey 1d
    timekey_wait 10m
    timekey_use_utc false
  </buffer>
  <format>
    @type json
  </format>
  path_suffix .log
</match>

# Save access logs to a separate file
<match express.request_completed>
  @type file
  path /fluentd/log/access
  append true
  <buffer time>
    timekey 1d
    timekey_wait 10m
    timekey_use_utc false
  </buffer>
  <format>
    @type json
  </format>
  path_suffix .log
</match>

# Save all other logs to a general file
<match **>
  @type file
  path /fluentd/log/general
  append true
  <buffer time>
    timekey 1d
    timekey_wait 10m
    timekey_use_utc false
  </buffer>
  <format>
    @type json
  </format>
  path_suffix .log
</match>

# Also output to stdout for debugging
<match **>
  @type stdout
</match>